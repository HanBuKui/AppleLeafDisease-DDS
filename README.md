# **README** 

## 目录

- 项目背景
- 开发环境
- 安装与使用
- 目录结构描述
- 数据集介绍
- 模型结构优化及调优策略
- 创新性说明
- 模型测试及对比

## 项目背景

​		褐斑病，花叶病，炭疽病和溃疡病是四种常见的猕猴桃叶部病害，对猕猴桃产业造成了严重的经济损失。及时准确地识别猕猴桃叶部病害对于控制病害的传播和保障猕猴桃产业的健康发展具有重要意义。本文提出了一种基于卷积神经网络的猕猴桃叶部病害识别方法。首先，通过使用图像增强技术生成由13022张图像组成的病害数据集。然后，研究猕猴桃叶部病斑特征的差异性，采用Kiwi-Inception结构和稠密连接策略实现多维度特征融合模块，构建出Kiwi-ConvNet卷积神经网络模型，在此基础上将其封装成软件，实现对常见猕猴桃叶部病害图像的高效准确识别的同时提升与用户的交互性。

## 开发环境

- 操作系统：Windows 10

- 编程语言: Python 3.7.3 MSC v.1915 64 bit (AMD64)

- 开发工具: PyCharm2018.3.5、Git

- 代码托管平台: Gitee

- 深度学习开发环境：

  实验环境采用的是高性能GPU计算平台，GPU型号为NVIDIA Tesla P100。并采用百度飞桨深度学习框架实现了所提出的Kiwi-ConvNet模型。平台开发环境如下表所示

  | Configuration            | Value                                     |
  | ------------------------ | ----------------------------------------- |
  | Type and specification   | Lenovo System X 3650 M5                   |
  | Central processing unit  | Intel® Xeon CPU E5-2650 v4 @ .20 GHz × 48 |
  | Graphics processor units | NVIDIA Tesla P100-PCIE-16GB × 2           |
  | Operation system         | Ubuntu 16.04.2 LTS (64-bit)               |
  | Memory                   | 512GB                                     |
  | Solid state disk         | 1.2TB                                     |
  | Deep learning framework  | Paddlepaddle                              |

## 安装与使用

​		将压缩包内“Identification of Kiwifruit Leaf Diseases Based on Convolutional Neural Network”解压到任意文件夹，使用Python IDE以项目形式打开，运行APP.py即可

注意：该项目使用到以下Python库或模块

- Paddlepaddle
- PyQt5
- numpy
- Pillow
- multiprocessing.cpu_count
- shutil
- random

 命令行直接键入`pip install modulename` + 回车 即可安装相应库

## 目录结构描述

```
├─.idea
├─data							// 数据集
│  ├─Anthrax
│  ├─Brown_Spot
│  ├─Mosaic
│  └─Ulcer
├─DeepLearning			// 深度学习模块
│  ├─infer_model
│  └─__pycache__
├─KiviFruit_app			// APP模块
│  ├─icon
│  ├─infer_model
│  ├─ui						
│  │  └─__pycache__
│  └─__pycache__
├─KiviFruit_web			// Web模块
│  ├─css
│  ├─html
│  ├─image
│  └─js
└─__pycache__
```

## 数据集介绍

​		通过实地拍摄和网络爬虫方式，获取了4种共766张的猕猴桃叶部病害图像数据集，包括325张花叶病、150张炭疽病、191张褐斑病与100张溃疡病。样本图像采集于西北农林科技大学猕猴桃试验站，使用 iPhone 6手机拍摄，其分辨率为2448×2058。

​		应用数字图线处理技术对原始数据集进行扩充，得到了共13022张图像的猕猴桃叶部病害数据集。再将数据集中的图像尺寸调整为256×256，以满足CNN模型对输入数据的要求。接着采用随机抽取的方式，将扩充后的数据集以3:7的比例划分为测试集与训练集，完成猕猴桃叶部病害数据集的建立。

数据集的具体信息如下表所示：

| Disease | Training/testing images | Total number |
| ------- | ----------------------- | ------------ |
| 花叶病  | 1785/765                | 2550         |
| 炭疽病  | 2272/975                | 3247         |
| 褐斑病  | 3876/1649               | 5525         |
| 溃疡病  | 1190/510                | 1700         |

## 模型结构优化及调优策略

### 改进Inception结构

​		为了提高模型的多维度特征提取能力，基于传统的Inception结构，设计出Kiwi-Inception结构。如图展示了传统的Inception结构和Kiwi-Inception结构，Kiwi-Inception结构包括并行的1×1卷积层、3×3卷积层、两个级联3×3卷积层与Max-pooling 池化层。相比于Inception结构，采用两个3×3卷积层来替换Inception结构中5×5卷积层，不仅减少参数量，同时也加速计算。同时，为了增强模型的特征提取能力，Kiwi-Inception增加了一条由一个1×1卷积层、两个3×3卷积层构成的通道。

![图片1](readme_img\图片1.png)

​		为了定量的分析改进Inception结构对模型识别性能的优化作用，使用Inception结构和Kiwi-Inception结构搭建的不同模型对比实验，其实验结果如图所示。采用Kiwi-Inception结构搭建的模型最终实现了96.40%的识别准确率，相比于原始的inception结构，准确率提高了2.19%。实验结果表明，Kiwi-Inception结构通过提高模型的多维度特征提取能力，提高了卷积神经网络模型对猕猴桃叶部病害的识别性能。

<img src="readme_img\图片2.png" alt="图片2" style="zoom:15%;" />

### 稠密链接策略

​		为了加强级联Kiwi-Inception模块之间特征的传递，从而更加高效地利用特征图，并且融合了各个通道的，多级联Kiwi-Inception模块采用稠密链接策略。

随着卷积神经网络层数的增加，易出现梯度消失的问题。造成该问题的主要原因是在使用反向传播算法传播梯度的时候，随着误差传递深度的不断增加，误差值会不断减小，最终导致浅层神经元的参数无法得到有效更新，使得模型无法有效学习。而稠密连接策略的采用，使得梯度信息可以直接传递至浅层，减小了梯度消失的可能性。稠密链接的示意图如图3所示。

​		为了定量的分析稠密链接策略对模型识别性能的优化作用，在移除稠密链接前后进行了对比实验。如图4所示，在采用了同样的训练策略下，应用稠密连接策略的模型获得了96.40%的识别准确率，比未应用稠密连接的识别率提高了2.23%。该实验表明，稠密连接策略使得特征图在神经网络模型中可以得到更加充分得使用，实现了多维度特征融合。稠密连接策略将卷积层中不同Kiwi-Inception连通，最大程度地保证模型中Kiwi-Inception之间的特征传递与利用。此外，随着网络模型规模的增大，梯度消失的问题出现的风险越大。但是稠密连接策略可以将梯度损失值直接传递至浅层Kiwi-Inception结构乃至于前置网络模块，因此降低梯度消失问题出现的风险，从而为CNN模型规模的扩大提供了保障。稠密连接策略在一定程度具有正则化效果，因此，对于过拟合具有一定的抑制作用。

<img src="readme_img\图片3.png" alt="图片3" style="zoom:50%;" />

### 数据增强

​		由于样本数量较少，直接用于卷积神经网络训练极易造成过拟合问题。为了提高模型的泛化性能，通过数据增强技术生成充足的猕猴桃叶部病害图像。一方面，模型在训练阶段能够学习丰富的相关高级语义特征，克服过拟合现象，另一方面，数据增强技术可以模拟采集样本时的不同的天气状况、摄像设备与目标之间的相对位置等等物理因素的影响，进而提高模型的泛化能力。

​		具体来说，调整图像对比度、亮度、锐化度以及采取高斯模糊技术来模拟天气因素对拍摄的影响；采用旋转变换，水平和垂直对称来模拟摄像机和患病叶片的相对位置；通过椒盐噪声与高斯噪声来模拟由于设备因素对拍摄图像的所造成的损害。此外，PCA 抖动与随机裁剪也被用于扩充原始数据集。

​		为了定量的分析数据集扩充技术对模型识别性能的优化作用，对数据集扩充前后进行对比实验。在没有扩充的图像数据集的情况下，所提出的模型具有极其不稳定的训练过程，最终实现了76.04％的识别率。然而，经过扩充后的样本集训练的模型实现了96.40％的准确率，相比于未扩展图像数据集，提高了约20.36％

<img src="readme_img\图片5.png" alt="图片5" style="zoom:50%;" />

## 创新性说明

### 算法原创性及优化改进部分

#### 算法原创性

1. 提出了一种基于数字图像处理的样本生成技术。该技术能够模拟图像采集的真实环境，为猕猴桃叶部病害识别提供充足的数据集，有效增强卷积神经网络模型的泛化能力。
2. 提出一种应用于猕猴桃叶部病害识别的卷积神经网络模型Kiwi-ConvNet。采用Kiwi-Inception结构和稠密连接策略实现多维度特征融合模块，并构建出Kiwi-ConvNet卷积神经网络模型，实现了对猕猴桃叶部病害的快速准确识别。

#### 优化改进部分

1. 引入并改进了GoogLeNet中的Inception结构，加强了病斑特征的多维度提取能力。
2. 对模型的参数进行优化，提升了模型的识别性能。

### 对其他作品的引用和区别

#### 对其他作品的引用

1. 借鉴Resnet中的残差链接思想，缓解在深度神经网络中增加深度带来的梯度消失问题。
2. 引用DenseNet中的稠密链接策略，加强了模型中的特征传递。

#### 与其他作品的区别

1. Kiwi-ConvNet集成众多经典的卷积神经模型的优点，是基于模型融合技术设计的全新的卷积神经网络模型。
2. 与其他经典模型相比，Kiwi-ConvNet是针对猕猴桃叶部病害特征设计的网络模型，在猕猴桃病害识别领域具有明显的性能优势。

## 模型测试及对比

为了测试模型的性能，将SVM（支持向量机）、BP神经网络、AlexNet、GoogLeNet、ResNet-20[20]与本文所提出的Kiwi-ConvNet模型在猕猴桃叶部病害测试集上进行对比测试。

如图表所示，Kiwi-ConvNet取得了最佳的识别性能，识别准确率为96.40%，优于其他识别模型。GoogLeNet由于采用了Inception结构而具多维度提取特征能力，因而具有较高的识别准确率，其识别准确率为93.48%。ResNet由于采用了“残差”思想，允许输入的原始特征信息能够直接传递至更深的层中，确保输入特征信息的完整性，对猕猴桃叶部病害图像表现出优异的识别性能，准确率为92.36%。AlexNet识别精度相对较低，仅有86.98%。BP神经网络与SVM算法分别具有57.46%和65.52%的识别准确率。与传统机器学习算法对比，基于卷积神经网络的方法不仅可以从多个维度自动提取最佳分类特征，而且将边缘、颜色等低级特征抽象为高级语义特征，最终提高了猕猴桃叶部病害的识别性能。

<img src=".\readme_img\图片7.png" alt="图片7" style="zoom:50%;" />

| 图像分类算法    | SVM    | BP神经网络 | AlexNet | GoogLeNet | ResNet-20 | Kiwi-ConvNet |
| --------------- | ------ | ---------- | ------- | --------- | --------- | ------------ |
| 识别准确率（%） | 65.52% | 57.46%     | 86.98%  | 93.48%    | 92.36%    | 96.40%       |